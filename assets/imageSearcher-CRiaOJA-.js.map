{"version":3,"file":"imageSearcher-CRiaOJA-.js","sources":["../../src/imageSearcher.js"],"sourcesContent":["import iziToast from \"izitoast\";\r\nimport \"izitoast/dist/css/iziToast.min.css\";\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\nconst gallery = document.querySelector(\".gallery\");\r\nconst form = document.querySelector(\".search-form\");\r\nconst loader = document.querySelector(\".loader\")\r\nconst input = document.querySelector(\"input[name='searchQuery']\");\r\nconst lmbtn = document.querySelector(\".lmbtn\")\r\nlet lightbox = null;\r\n\r\nlet currentQuery = \"\";\r\nlet currentPage = 1;\r\nconst perPage = 40;\r\nlet totalHits = 0;\r\nconst MAX_PAGES = 3;\r\n\r\n\r\nform.addEventListener(\"submit\", (event) => {\r\n    event.preventDefault()\r\n    const userInput = input.value\r\n    userSearch(userInput)\r\n} )\r\n\r\nwindow.rejectAlert = function(message) {\r\n  iziToast.show({\r\n    message: message,\r\n    position: 'topRight',\r\n    messageColor: \"#ffffff\",\r\n    backgroundColor: \"#d15858\",\r\n  });\r\n}\r\n\r\nconst fetchImages = async (query, page) => {\r\n   console.log(\"Fetching:\", { query, page }); \r\n  const apiKey = \"50495832-52e00f4195b6d2cb1ef4fba52\";\r\n  const perPage = 40;\r\n  const url = `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&per_page=${perPage}&page=${page}`;\r\n  \r\n  const res = await fetch(url);\r\n  if (!res.ok) throw new Error(\"Network response was not ok\");\r\n  return await res.json();\r\n};\r\n\r\nconst userSearch = async (userInput) => {\r\n  gallery.innerHTML = \"\";\r\n  lmbtn.classList.add(\"visualy-hidden\");\r\n  currentPage = 1;\r\n  const trimmedInput = userInput.trim();\r\n  currentQuery = trimmedInput;\r\n  if (trimmedInput === \"\") {\r\n    return rejectAlert(\"Sorry, there are no images matching your search query. Please try again!\");\r\n  }\r\n\r\n  loader.style.display = 'block';\r\n\r\n  try {\r\n    const data = await fetchImages(currentQuery, currentPage);\r\n    const images = data.hits;\r\n    totalHits = data.totalHits;\r\n\r\n    loader.style.display = 'none';\r\n\r\n    if (images.length === 0) {\r\n      return rejectAlert(\"Sorry, there are no images matching your search query. Please try again!\");\r\n    }\r\n\r\n    renderGallery(images);\r\n    lmbtn.classList.remove(\"visualy-hidden\");\r\n    currentPage += 1;\r\n\r\n  } catch (error) {\r\n    loader.style.display = 'none';\r\n    console.error(error);\r\n    return rejectAlert(\"Something went wrong. Please try again later.\");\r\n  }\r\n};\r\n\r\nconst loadMoreImages = async () => {\r\n  console.log(currentPage)\r\n  if (currentPage >= MAX_PAGES) {\r\n    lmbtn.classList.add(\"visualy-hidden\");\r\n    rejectAlert(\"We're sorry, but you've reached the end of search results.\");\r\n    return; \r\n  }\r\n   const galleryItem = document.querySelector('.gallery-item');\r\n  if (galleryItem) {\r\n    const { height } = galleryItem.getBoundingClientRect();\r\n    window.scrollBy({\r\n      top: height * 2,\r\n      behavior: 'instant',\r\n    });\r\n  }\r\n  loader.style.display = 'block';\r\n\r\n  try {\r\n    const data = await fetchImages(currentQuery, currentPage);\r\n    const images = data.hits;\r\n\r\n    loader.style.display = 'none';\r\n\r\n    renderGallery(images);\r\n    currentPage += 1;\r\n\r\n    const galleryItem = document.querySelector('.gallery-item');\r\n  if (galleryItem) {\r\n    const { height } = galleryItem.getBoundingClientRect();\r\n    window.scrollBy({\r\n      top: height * 2,\r\n      behavior: 'smooth',\r\n    });\r\n  }\r\n  } catch (error) {\r\n    loader.style.display = 'none';\r\n    console.error(error);\r\n    rejectAlert(\"Something went wrong. Please try again later.\");\r\n  }\r\n};\r\nlmbtn.addEventListener(\"click\", loadMoreImages)\r\n// const createGallery = (res) => {\r\n//   const imgs = images.map(renderImage);\r\n//   container.append(...imgs);\r\n// };\r\nconst renderImage = (image) => {\r\n    const { webformatURL, largeImageURL, tags, likes, views, comments, downloads } = image;\r\n  const li = document.createElement('li');\r\n  li.classList.add('gallery-item');\r\n\r\n  const link = document.createElement('a');\r\n  link.classList.add('gallery-link');\r\n  link.href = largeImageURL;\r\n\r\n  const img = document.createElement('img');\r\n  img.classList.add('gallery-image');\r\n  img.src = webformatURL;\r\n  img.alt = tags.split(',')[0];\r\n\r\n    const statsBox = document.createElement('div');\r\n    statsBox.classList.add(\"imageStats\")\r\n\r\n    const likesBox = document.createElement('div');\r\n    likesBox.classList.add(\"stat-box\");\r\n\r\n    const likesTitle = document.createElement('span');\r\n    likesTitle.classList.add(\"stat-name\");\r\n    likesTitle.textContent = \"Likes\"\r\n\r\n    const likesNum = document.createElement('span')\r\n    likesNum.classList.add(\"stat-amount\")\r\n    likesNum.textContent = likes\r\n\r\n        const viewsBox = document.createElement('div');\r\n    viewsBox.classList.add(\"stat-box\");\r\n\r\n    const viewsTitle = document.createElement('span');\r\n    viewsTitle.classList.add(\"stat-name\");\r\n    viewsTitle.textContent = \"Views\"\r\n\r\n    const viewsNum = document.createElement('span')\r\n    viewsNum.classList.add(\"stat-amount\")\r\n    viewsNum.textContent = views\r\n\r\n        const commentsBox = document.createElement('div');\r\n    commentsBox.classList.add(\"stat-box\");\r\n\r\n    const commentsTitle = document.createElement('span');\r\n    commentsTitle.classList.add(\"stat-name\");\r\n    commentsTitle.textContent = \"Comments\"\r\n\r\n    const commentsNum = document.createElement('span')\r\n    commentsNum.classList.add(\"stat-amount\")\r\n    commentsNum.textContent = comments\r\n\r\n        const downloadsBox = document.createElement('div');\r\n    downloadsBox.classList.add(\"stat-box\");\r\n\r\n    const downloadsTitle = document.createElement('span');\r\n    downloadsTitle.classList.add(\"stat-name\");\r\n    downloadsTitle.textContent = \"Downloads\"\r\n\r\n    const downloadsNum = document.createElement('span')\r\n    downloadsNum.classList.add(\"stat-amount\")\r\n    downloadsNum.textContent = downloads\r\n  \r\n    likesBox.append(likesTitle, likesNum); \r\n    statsBox.appendChild(likesBox);\r\n\r\n    viewsBox.append(viewsTitle, viewsNum); \r\n    statsBox.appendChild(viewsBox);\r\n\r\n    commentsBox.append(commentsTitle, commentsNum); \r\n    statsBox.appendChild(commentsBox);\r\n\r\n    downloadsBox.append(downloadsTitle, downloadsNum); \r\n    statsBox.appendChild(downloadsBox);\r\n\r\n\r\n    link.appendChild(img);\r\n    li.append(link, statsBox);\r\n\r\n    return li;\r\n};\r\n\r\nconst renderGallery = (images) => {\r\n  const items = images.map(renderImage); \r\n  gallery.append(...items);\r\n\r\n  if (lightbox) {\r\n    lightbox.refresh();\r\n  } else {\r\n    lightbox = new SimpleLightbox('.gallery a', {\r\n      captionsData: 'alt',\r\n      captionDelay: 250,\r\n    });\r\n  }\r\n};"],"names":["gallery","form","loader","input","lmbtn","lightbox","currentQuery","currentPage","totalHits","MAX_PAGES","event","userInput","userSearch","message","iziToast","fetchImages","query","page","url","res","trimmedInput","data","images","renderGallery","error","loadMoreImages","galleryItem","height","renderImage","image","webformatURL","largeImageURL","tags","likes","views","comments","downloads","li","link","img","statsBox","likesBox","likesTitle","likesNum","viewsBox","viewsTitle","viewsNum","commentsBox","commentsTitle","commentsNum","downloadsBox","downloadsTitle","downloadsNum","items","SimpleLightbox"],"mappings":"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"}